---
title: "plots"
output: html_document
date: "2024-02-06"
---

```{r setup, include=FALSE}

# running in R version 4.3.1

#### Clear  environment 
rm(list = ls())         

#### Required packages
library(tidyverse) # for general organisation
library(ggplot2)
library(dplyr)
library(zoo)

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
# load the data 
brighton <- read.csv("Hotmess_R.csv")

brighton$Sampling_Date <- as.Date(brighton$Sampling_Date, format = "%d/%m/%Y")

brighton$Pad_Region <- as.factor(brighton$Pad_Region)

brighton$Pad_Colour <- as.factor(brighton$Pad_Colour)

brighton$total_grazer <- brighton$Gastropod_Count_ON + brighton$Gastropod_Count_SIDE

# create a new column for the combinations
brighton <- brighton %>%
  mutate(Combination = interaction(Pad_Colour, Pad_Region))

str(brighton)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
# create a list of our numeric explanatory and response variables
numeric_vars <- c("Nitrate", "Phosphorous", "Salinity", "Precipitation", 
                  "Temperature", "Wind_Speed", "Solar_Insolation",
                  "Barnacle_Species_Number", "Gastropod_Count_ON", 
                  "Gastropod_Count_SIDE", "Barnacle_Count", "Green_Algae", 
                  "Cyanobacteria", "Diatoms", "AVG_Banacle_Size", 
                  "SD_Barnacle_Size")

# as there are 16, we'll set up a 4 by 4 panel 
par(mfrow = c(4, 4))

# loop over numeric_vars and create a histogram for each one
for (var in numeric_vars) {
  hist(brighton[[var]], main = var, xlab = var, col = "lightblue", border = "black")
}

```
```{r}
#ADD CODE FOR COMBINATION
```




```{r}
#barnacle count


average_barnacle_count <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarize(Average_Banacle_Count = mean(Barnacle_Count, na.rm = TRUE))
            
            #,  SE_Banacle_Size = sd(AVG_Banacle_Size, na.rm = TRUE)/ sqrt(n()),, .groups = 'drop')


# Assuming `data` is your original dataset with individual observations
data_se_b_count <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarise(
    Avg = mean(Barnacle_Count),
    SE = sd(Barnacle_Count) / sqrt(n()),
    Lower = Avg - SE,  # Assuming 1 SE for the demonstration
    Upper = Avg + SE
  ) %>%
  ungroup()

combined_plot_b_count <- ggplot() +
  geom_line(data = average_barnacle_count, 
            aes(x = Sampling_Date, y = Average_Banacle_Count, group = Combination, color = Combination)) +
  geom_point(data = average_barnacle_count, 
             aes(x = Sampling_Date, y = Average_Banacle_Count, color = Combination), size = 2) +
  #geom_ribbon(data = data_se, aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, fill = Combination), alpha = 0.2) +  # Add this line for shaded areas
  geom_errorbar(data = data_se_b_count, 
                aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, color = Combination), 
                width = 0.5) +  # Adjust width as needed
  geom_jitter(data = brighton, 
             aes(x = Sampling_Date, y = Barnacle_Count, color = Combination), size = 1, alpha = 0.35, width = 2) +
  scale_color_manual(values = c("B.N" = "hotpink", "W.N" = "orange", "B.P" = "blue", "W.P" = "green", "B" = "black", "W" = "grey"),
                     labels = c("B.N" = "Non-Polluted + Warming", "W.N" = "Non-Polluted + Control", "B.P" = "Polluted + Warming", "W.P" = "Polluted + Control")) +
  scale_shape_manual(values = c("N" = 16, "P" = 17),
                     labels = c("N" = "Non-Polluted Region", "P" = "Polluted Region")) +
  labs(title = "Average Barnacle Count Over Time",
       x = "Sampling Date",
       y = "Average Barnacle Count") +
  theme_minimal()

combined_plot_b_count
 

```



```{r}

#barnacle size

average_barnacle_size <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarize(Average_Banacle_Size = mean(AVG_Banacle_Size, na.rm = TRUE))
            
            #,  SE_Banacle_Size = sd(AVG_Banacle_Size, na.rm = TRUE)/ sqrt(n()),, .groups = 'drop')


# Assuming `data` is your original dataset with individual observations
data_se_b_size <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarise(
    Avg = mean(AVG_Banacle_Size),
    SE = sd(AVG_Banacle_Size) / sqrt(n()),
    Lower = Avg - SE,  # Assuming 1 SE for the demonstration
    Upper = Avg + SE
  ) %>%
  ungroup()

combined_plot_b_size <- ggplot() +
  geom_line(data = average_barnacle_size, 
            aes(x = Sampling_Date, y = Average_Banacle_Size, group = Combination, color = Combination)) +
  geom_point(data = average_barnacle_size, 
             aes(x = Sampling_Date, y = Average_Banacle_Size, color = Combination), size = 2) +
  #geom_ribbon(data = data_se, aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, fill = Combination), alpha = 0.2) +  # Add this line for shaded areas
  geom_errorbar(data = data_se_b_size, 
                aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, color = Combination), 
                width = 0.5) +  # Adjust width as needed
  geom_jitter(data = brighton, 
             aes(x = Sampling_Date, y = AVG_Banacle_Size, color = Combination), size = 1, alpha = 0.35, width = 2) +
  scale_color_manual(values = c("B.N" = "hotpink", "W.N" = "orange", "B.P" = "blue", "W.P" = "green", "B" = "black", "W" = "grey"),
                     labels = c("B.N" = "Non-Polluted + Warming", "W.N" = "Non-Polluted + Control", "B.P" = "Polluted + Warming", "W.P" = "Polluted + Control", "B" = "Pad Colour: Black", "W" = "Pad Colour: Grey")) +
  scale_shape_manual(values = c("N" = 16, "P" = 17),
                     labels = c("N" = "Non-Polluted Region", "P" = "Polluted Region")) +
  labs(title = "Average Barnacle Size Over Time",
       x = "Sampling Date",
       y = "Average Barnacle Size") +
  theme_minimal()

combined_plot_b_size
 
```




```{r}

#diatoms

average_diatoms <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarize(Average_diatoms = mean(Diatoms, na.rm = TRUE), .groups = 'drop')

# Assuming `data` is your original dataset with individual observations
data_se_diatoms <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarise(
    Avg = mean(Diatoms),
    SE = sd(Diatoms) / sqrt(n()),
    Lower = Avg - SE,  # Assuming 1 SE for the demonstration
    Upper = Avg + SE
  ) %>%
  ungroup()

combined_plot_diatoms <- ggplot() +
  geom_line(data = average_diatoms, 
            aes(x = Sampling_Date, y = Average_diatoms, group = Combination, color = Combination)) +
  geom_point(data = average_diatoms, 
             aes(x = Sampling_Date, y = Average_diatoms, color = Combination), size = 2) +
  #geom_ribbon(data = data_se, aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, fill = Combination), alpha = 0.2) +  # Add this line for shaded areas
  geom_errorbar(data = data_se_diatoms, 
                aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, color = Combination), 
                width = 0.5) +  # Adjust width as needed
  geom_jitter(data = brighton, 
             aes(x = Sampling_Date, y = Diatoms, color = Combination), size = 1, alpha = 0.35, width = 2) +
  scale_color_manual(values = c("B.N" = "hotpink", "W.N" = "orange", "B.P" = "blue", "W.P" = "green", "B" = "black", "W" = "grey"),
                     labels = c("B.N" = "Non-Polluted + Warming", "W.N" = "Non-Polluted + Control", "B.P" = "Polluted + Warming", "W.P" = "Polluted + Control", "B" = "Pad Colour: Black", "W" = "Pad Colour: Grey")) +
  scale_shape_manual(values = c("N" = 16, "P" = 17),
                     labels = c("N" = "Non-Polluted Region", "P" = "Polluted Region")) +
  labs(title = "Diatom Concentrations Over Time",
       x = "Sampling Date",
       y = "Diatoms Concentration") +
  theme_minimal()


combined_plot_diatoms

#check temp in august!

```


```{r}

#cyanobacteria
#combination plot points w/ mean and lines

average_cyanobacteria <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarize(Average_Cyanobacteria = mean(Cyanobacteria, na.rm = TRUE), .groups = 'drop')


# Assuming `data` is your original dataset with individual observations
data_se_cyano <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarise(
    Avg = mean(Cyanobacteria),
    SE = sd(Cyanobacteria) / sqrt(n()),
    Lower = Avg - SE,  # Assuming 1 SE for the demonstration
    Upper = Avg + SE
  ) %>%
  ungroup()


#cyano plot

combined_plot_cyanobacteria <- ggplot() +
  geom_line(data = average_cyanobacteria, 
            aes(x = Sampling_Date, y = Average_Cyanobacteria, group = Combination, color = Combination)) +
  geom_point(data = average_cyanobacteria, 
             aes(x = Sampling_Date, y = Average_Cyanobacteria, color = Combination), size = 2) +
  #geom_ribbon(data = data_se, aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, fill = Combination), alpha = 0.2) +  # Add this line for shaded areas
  geom_errorbar(data = data_se_cyano, 
                aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, color = Combination), 
                width = 0.5) +  # Adjust width as needed
  geom_jitter(data = brighton, 
             aes(x = Sampling_Date, y = Cyanobacteria, color = Combination), size = 1, alpha = 0.35, width = 2) +
  scale_color_manual(values = c("B.N" = "hotpink", "W.N" = "orange", "B.P" = "blue", "W.P" = "green", "B" = "black", "W" = "grey"),
                     labels = c("B.N" = "Non-Polluted + Warming", "W.N" = "Non-Polluted + Control", "B.P" = "Polluted + Warming", "W.P" = "Polluted + Control", "B" = "Pad Colour: Black", "W" = "Pad Colour: Grey")) +
  scale_shape_manual(values = c("N" = 16, "P" = 17),
                     labels = c("N" = "Non-Polluted Region", "P" = "Polluted Region")) +
  labs(title = "Cyanobacteria Concentrations Over Time",
       x = "Sampling Date",
       y = "Cyanobacteria Concentration") +
  theme_minimal()


combined_plot_cyanobacteria

```




```{r}

#green

average_green <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarize(Average_Green = mean(Green_Algae, na.rm = TRUE), .groups = 'drop')



data_se <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarise(
    Avg = mean(Green_Algae),
    SE = sd(Green_Algae) / sqrt(n()),
    Lower = Avg - SE,  # Assuming 1 SE for the demonstration
    Upper = Avg + SE
  ) %>%
  ungroup()


#green plot

combined_plot_green <- ggplot() +
  geom_line(data = average_green, 
            aes(x = Sampling_Date, y = Average_Green, group = Combination, color = Combination)) +
  geom_point(data = average_green, 
             aes(x = Sampling_Date, y = Average_Green, color = Combination), size = 2) +
  #geom_ribbon(data = data_se, aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, fill = Combination), alpha = 0.2) +  # Add this line for shaded areas
  geom_errorbar(data = data_se, 
                aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, color = Combination), 
                width = 0.5) +  # Adjust width as needed
  geom_jitter(data = brighton, 
             aes(x = Sampling_Date, y = Green_Algae, color = Combination), size = 1, alpha = 0.35, width = 2) +
  scale_color_manual(values = c("B.N" = "hotpink", "W.N" = "orange", "B.P" = "blue", "W.P" = "green", "B" = "black", "W" = "grey"),
                     labels = c("B.N" = "Non-Polluted + Warming", "W.N" = "Non-Polluted + Control", "B.P" = "Polluted + Warming", "W.P" = "Polluted + Control", "B" = "Pad Colour: Black", "W" = "Pad Colour: Grey")) +
  scale_shape_manual(values = c("N" = 16, "P" = 17),
                     labels = c("N" = "Non-Polluted Region", "P" = "Polluted Region")) +
  labs(title = "Green Algae Concentrations Over Time",
       x = "Sampling Date",
       y = "Cyanobacteria Concentration") +
  theme_minimal()


combined_plot_green
```
## Grazers


```{r}
#Grazers

#add new column for grazer total
brighton$total_grazer <- brighton$Gastropod_Count_ON + brighton$Gastropod_Count_SIDE


average_grazer <- brighton %>%
  group_by(Sampling_Date, Combination) %>%
  summarize(Average_Grazer = mean(total_grazer, na.rm = TRUE), .groups = 'drop')


# Assuming `data` is your original dataset with individual observations
grazer_se <- average_grazer %>%
  group_by(Sampling_Date, Combination) %>%
  summarise(
    Avg = mean(Average_Grazer),
    SE = sd(Average_Grazer) / sqrt(n()),
    Lower = Avg - SE,  # Assuming 1 SE for the demonstration
    Upper = Avg + SE
  ) %>%
  ungroup()


#grazer plot

combined_plot_grazer <- ggplot() +
  geom_line(data = average_grazer, 
            aes(x = Sampling_Date, y = Average_Grazer, group = Combination, color = Combination)) +
  geom_point(data = average_grazer, 
             aes(x = Sampling_Date, y = Average_Grazer, color = Combination), size = 2) +
  #geom_ribbon(data = data_se, aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, fill = Combination), alpha = 0.2) +  # Add this line for shaded areas
  geom_errorbar(data = data_se, 
                aes(x = Sampling_Date, ymin = Lower, ymax = Upper, group = Combination, color = Combination), 
                width = 0.5) +  # Adjust width as needed
  geom_jitter(data = brighton, 
             aes(x = Sampling_Date, y = total_grazer, color = Combination), size = 1, alpha = 0.35, width = 2) +
  scale_color_manual(values = c("B.N" = "hotpink", "W.N" = "orange", "B.P" = "blue", "W.P" = "green", "B" = "black", "W" = "grey"),
                     labels = c("B.N" = "Non-Polluted + Warming", "W.N" = "Non-Polluted + Control", "B.P" = "Polluted + Warming", "W.P" = "Polluted + Control", "B" = "Pad Colour: Black", "W" = "Pad Colour: Grey")) +
  scale_shape_manual(values = c("N" = 16, "P" = 17),
                     labels = c("N" = "Non-Polluted Region", "P" = "Polluted Region")) +
  labs(title = "Grazer Counts Over Time",
       x = "Sampling Date",
       y = "Grazer Count") +
  theme_minimal()


combined_plot_grazer
```




##BOXPLOTS

##change colours to mathc TS graphs?

#Barnacle Count

```{r}

sub_JUN_1 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-06-20'))

boxplot(Barnacle_Count ~ Pad_Colour*Pad_Region, data = sub_JUN_1,
       xlab = "Treatment group",
       ylab = "Barnacle Count") 


BP_Jun_1_BC <- ggplot(sub_JUN_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count, fill = interaction(Pad_Colour, Pad_Region, sep = " + ")))+
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) + 
  scale_fill_manual(values = c("B + N" = "hotpink",
                               "W + N" = "orange",
                               "B + P" = "blue",
                               "W + P" = "green"))
                      

BP_Jun_1_BC


```

```{r}
sub_JUL_1 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-07-06'))


BP_Jul_1_BC <- ggplot(sub_JUL_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count))   +
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_1_BC
```
```{r}
sub_JUL_2 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-07-20'))

BP_Jul_2_BC <- ggplot(sub_JUL_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count))   +
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_2_BC
```
```{r}
sub_AUG_1 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-08-01'))

BP_Aug_1_BC <- ggplot(sub_AUG_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count))   +
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_1_BC

```
```{r}
sub_AUG_2 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-08-17'))

BP_Aug_2_BC <- ggplot(sub_AUG_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count))   +
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_2_BC

```
```{r}
sub_SEP_1 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-09-01'))

BP_Sep_1_BC <- ggplot(sub_SEP_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count))   +
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_1_BC
```
```{r}
sub_SEP_2 <- brighton %>%
  filter(Sampling_Date >= as.Date('2023-09-15'))


BP_Sep_2_BC <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Barnacle_Count))   +
  geom_boxplot() +
  labs(title = "Barnacle Count Boxplots",
       x = "Treatment Group",
       y = "Barnacle Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_2_BC

```
# Barnacle Size

```{r}
#Jun 1

BP_Jun_1_BS <- ggplot(sub_JUN_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jun_1_BS
```

```{r}
#Jul 1

BP_Jul_1_BS <- ggplot(sub_JUL_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_1_BS

```

```{r}
#Jul 2

BP_Jul_2_BS <- ggplot(sub_JUL_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_2_BS
```

```{r}
#Aug 1

BP_Aug_1_BS <- ggplot(sub_AUG_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_1_BS
```


```{r}
#Aug 2

BP_Aug_2_BS <- ggplot(sub_AUG_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_2_BS

```



```{r}
#Sep 1

BP_Sep_1_BS <- ggplot(sub_SEP_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_1_BS
```

```{r}
#Sep 2

BP_Sep_2_BS <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = AVG_Banacle_Size)) +
  geom_boxplot() +
  labs(title = "Barnacle Size Boxplots",
       x = "Treatment Group",
       y = "Barnacle Size") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_2_BS
```


##Diatoms


```{r}
#Jun 1

  BP_Jun_1_D <- ggplot(sub_JUN_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatoms Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jun_1_D
```

```{r}
#Jul 1

BP_Jul_1_D <- ggplot(sub_JUL_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatom Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_1_D

```

```{r}
#Jul 2

BP_Jul_2_D <- ggplot(sub_JUL_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatoms Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_2_D
```

```{r}
#Aug 1

BP_Aug_1_D <- ggplot(sub_AUG_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatoms Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_1_D
```


```{r}
#Aug 2

BP_Aug_2_D <- ggplot(sub_AUG_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatoms Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_2_D

```

```{r}
#Sep 1

BP_Sep_1_D <- ggplot(sub_SEP_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatoms Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_1_D
```

```{r}
#Sep 2

BP_Sep_2_D <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Diatoms)) +
  geom_boxplot() +
  labs(title = "Diatoms Boxplots",
       x = "Treatment Group",
       y = "Diatoms") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_2_D
```


##Green Algae


```{r}
#Jun 1

  BP_Jun_1_GA <- ggplot(sub_JUN_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jun_1_GA
```

```{r}
#Jul 1

BP_Jul_1_GA <- ggplot(sub_JUL_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_1_GA
```

```{r}
#Jul 2

BP_Jul_2_GA <- ggplot(sub_JUL_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_2_GA
```

```{r}
#Aug 1

BP_Aug_1_GA <- ggplot(sub_AUG_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_1_GA
```


```{r}
#Aug 2

BP_Aug_2_GA <- ggplot(sub_AUG_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_2_GA

```

```{r}
#Sep 1

BP_Sep_1_GA <- ggplot(sub_SEP_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_1_GA
```

```{r}
#Sep 2

BP_Sep_2_GA <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Green_Algae)) +
  geom_boxplot() +
  labs(title = "Green Algae Boxplots",
       x = "Treatment Group",
       y = "Green Algae") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_2_GA
```




##Cyanobacteria


```{r}
#Jun 1

  BP_Jun_1_C <- ggplot(sub_JUN_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jun_1_C
```

```{r}
#Jul 1

BP_Jul_1_C <- ggplot(sub_JUL_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_1_C

```

```{r}
#Jul 2

BP_Jul_2_C <- ggplot(sub_JUL_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_2_C
```

```{r}
#Aug 1

BP_Aug_1_C <- ggplot(sub_AUG_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_1_C
```


```{r}
#Aug 2

BP_Aug_2_C <- ggplot(sub_AUG_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria")+
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_2_C
```
```{r}
#Sep 1

BP_Sep_1_C <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_1_C
```



```{r}
#Sep 2

BP_Sep_2_C <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = Cyanobacteria)) +
  geom_boxplot() +
  labs(title = "Cyanobacteria Boxplots",
       x = "Treatment Group",
       y = "Cyanobacteria") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_2_C
```
##GRAZER BOXPLOTS

```{r}
BP_Jun_1_GA <- ggplot(sub_JUN_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jun_1_GA
```


```{r}
BP_Jul_1_GA <- ggplot(sub_JUL_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_1_GA
```


```{r}
BP_Jul_2_GA <- ggplot(sub_JUL_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Jul_2_GA
```


```{r}
BP_Aug_1_GA <- ggplot(sub_AUG_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_1_GA
```


```{r}
BP_Aug_2_GA <- ggplot(sub_AUG_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Aug_2_GA
```



```{r}
BP_Sep_1_GA <- ggplot(sub_SEP_1, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_1_GA
```

```{r}
BP_Sep_2_GA <- ggplot(sub_SEP_2, aes(x = interaction(Pad_Colour, Pad_Region, sep = " + "), y = total_grazer)) +
  geom_boxplot() +
  labs(title = "Grazer Boxplots",
       x = "Treatment Group",
       y = "Grazer") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_x_discrete(labels = c("B + N" = "Warm + Non-Polluted",
                              "W + N" = "Control Temperature + Non-Polluted",
                              "B + P" = "Warm + Polluted",
                              "W + P" = "Control Temperature + Polluted")) # Updated custom labels

BP_Sep_2_GA
```


## ARIMA

```{r}
brighton <- read.csv("Hotmess_R.csv")
# Create a list of subsets based on all combinations of 'sampling region' and 'pad colour'
subset_list <- split(brighton, list(brighton$Pad_Region, brighton$Pad_Colour))

# Access a specific subset (e.g., Region1 + Color1)
p.w.sub <- subset_list[["P.W"]]
p.b.sub <- subset_list[["P.B"]]
n.w.sub <- subset_list[["N.W"]]
n.b.sub <- subset_list[["N.B"]]

```

```{r}


#PW
p.w.sub <- p.w.sub %>%
  group_by(Sampling_Date) %>%
  summarise(avg_Barnacle_Count = mean(Barnacle_Count, na.rm = TRUE))


# Create a zoo object with irregular time points
p.w.ts <- zoo(p.w.sub$avg_Barnacle_Count, order.by = p.w.sub$Sampling_Date)


# Remove rows with NA, NaN, Inf, or -Inf in the time series
p.w.ts <- na.omit(p.w.ts) # Removes rows with NA
p.w.ts <- p.w.ts[is.finite(p.w.ts)] # Keeps only finite values


# Step 1: Visual Inspection
plot(p.w.ts)

```
```{r}

```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
